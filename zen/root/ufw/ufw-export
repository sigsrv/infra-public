
#!/usr/bin/env python3
"""
/usr/local/bin/ufw-export
"""
import gettext

from ufw.backend_iptables import UFWBackendIptables  # noqa
from ufw.parser import UFWCommandRule, UFWCommandRouteRule  # noqa


def main():
    gettext.install("ufw")

    rules = []
    for rule in UFWBackendIptables(dryrun=True).get_rules():
        if not rule.forward:
            rules.append(("ufw", UFWCommandRule.get_command(rule)))
        else:
            rules.append(("ufw", "route", UFWCommandRouteRule.get_command(rule)))

    visited_rules = set()
    for rule in rules:
        if rule not in visited_rules:
            visited_rules.add(rule)
            print(*rule)


if __name__ == '__main__':
    main()
